{% extends "base.html" %}

{% block content %}
	{% if todos %}
	<div class="greybox">
		<h3 class="title">Package ToDo Lists</h3>
		<table class="results" width="100%">
			<tr>
				<th>Name</th>
				<th>Creation Date</th>
				<th>Description</th>
			</tr>
		{% for todo in todos %}
            <tr class="{% cycle pkgr2,pkgr1 %}">
				<td style="white-space:nowrap"><a href="/todo/{{ todo.id }}/">{{ todo.name }}</a></td>
				<td>{{ todo.date_added }}</td>
				<td>{{ todo.description }}</td>
			</tr>
		{% endfor %}
		</table>
	</div>
	<br /><br />
	{% endif %}
	
    <div class="greybox">
		<h3 class="title">Stats by Architecture</h3>
		<table class="results" width="100%">
			<tr>
				<th width="50%">Arch</th>
				<th># Packages</th>
				<th># Flagged</th>
			</tr>
		{% for arch in arches %}
            <tr class="{% cycle pkgr2,pkgr1 %}">
				<td><strong>{{ arch.name }}</strong></td>
				<td><a href="/packages/?arch={{ arch.name }}"><strong>{{ arch.packages.count }}</strong> packages</a></td>
				<td><a href="/packages/?arch={{ arch.name }}&flagged=Flagged"><strong>{{ arch.packages.flagged.count }}</strong> packages</a></td>
			</tr>
		{% endfor %}
		</table>
	</div>
	<br /><br />
    <div class="greybox">
		<h3 class="title">Stats by Repository</h3>
		<table class="results" width="100%">
			<tr>
				<th width="50%">Repository</th>
				<th># Packages</th>
				<th># Flagged</th>
			</tr>
		{% for repo in repos %}
            <tr class="{% cycle pkgr2,pkgr1 %}">
				<td><strong>{{ repo.name }}</strong></td>
				<td><a href="/packages/?repo={{ repo.name }}"><strong>{{ repo.packages.count }}</strong> packages</a></td>
				<td><a href="/packages/?repo={{ repo.name }}&flagged=Flagged"><strong>{{ repo.packages.flagged.count }}</strong> packages</a></td>
			</tr>
		{% endfor %}
		</table>
	</div>
	<br /><br />

	<div class="greybox">
		<h3 class="title">Stats by Maintainer</h3>
		<table class="results" width="100%">
			<tr>
				<th width="50%">Maintainer</th>
				<th># Packages</th>
				<th># Flagged</th>
			</tr>
		{% for maint in maintainers %}
            <tr class="{% cycle pkgr2,pkgr1 %}">
				<td><strong>{{ maint.get_full_name }}</strong></td>
				<td><a href="/packages/?maintainer={{ maint.username }}"><strong>{{ maint.maintained_packages.count }}</strong> packages</a></td>
				<td><a href="/packages/?maintainer={{ maint.username }}&flagged=Flagged"><strong>{{ maint.maintained_packages.flagged.count }}</strong> packages</a></td>
			</tr>
		{% endfor %}
		</table>
	</div>
	<br /><br />

	<div class="greybox">
		<h3 class="title">My Flagged Packages</h3>
        <form method="post" action="/devel/notify/">
            <input name="notify" type="checkbox" value="yes"
            {% if user.get_profile.notify %} checked="checked"{% endif %} />
            Notify me when packages are flagged&nbsp;&nbsp;
            <input type="submit" value="Update" />
        </form>
		<br />
		<table class="results" width="100%">
			<tr>
				<th style="width: 50%">Name</th>
				<th>Repo</th>
				<th>Version</th>
				<th>Arch</th>
			</tr>
                {% for pkg in user.maintained_packages.flagged %}
                <tr class="{% cycle pkgr2,pkgr1 %}">
                    <td>
                        <a href="/packages/{{ pkg.id }}/">{{ pkg.pkgname }}</a>
                    </td>
                    <td>{{ pkg.pkgver }}</td>
                    <td>{{ pkg.repo.name }}</td>
                    <td>{{ pkg.arch.name }}</td>
                </tr>
                {% endfor %}
		</table>
{% endblock %}
