{% extends "base.html" %}
{% block title %}Arch Linux - Package Details - {{ pkg.pkgname }}{% endblock %}
{% block content %}
    <div class="box">
        <h2 class="title">{{ pkg.pkgname }} {{ pkg.pkgver }}-{{ pkg.pkgrel }}</h2>
        <div style="float:right" class="listing">
            <ul class="small">
                <li><a href="{{ pkg.get_arch_svn_link }}">SVN Entries ({{pkg.repo|lower}}-{{pkg.arch}})</a></li>
                <li><a href="{{ pkg.get_trunk_svn_link }}">SVN Entries (trunk)</a></li>
                <li><a href="{{ pkg.get_bugs_link }}">Bug Reports</a></li>
                <li>
            {% if pkg.needupdate %}
                <span style="font-size:x-small"><em>This package has been flagged out-of-date</em></span>
                {% if user.is_authenticated %}
                <br />&nbsp; &nbsp; <a href="/packages/unflag/{{ pkg.id }}/">Click here to unflag</a>
                {% endif %}
            {% else %}
                <a href="/packages/flag/{{ pkg.id }}/">Flag Package Out-of-Date</a>
                <a href="/packages/flaghelp/" onclick="return !window.open('/packages/flaghelp','FlagHelp','height=350,width=450,location=no,scrollbars=yes,menubars=no,toolbars=no,resizable=no');"><span style="font-size:x-small">(?)</span></a>
            {% endif %}
                </li>
                {% if user.is_authenticated %}
                  <li>&nbsp;</li>
                  <li>
                  <form name="devaction" method="post" action="/packages/update/">
                      <input type="hidden" name="pkgid" value="{{ pkg.id }}" />
                      <input type="submit" style="background: #e1e3e6;" name="adopt" value="Adopt Package" />
                      <input type="submit" style="background: #e1e3e6;" name="disown" value="Disown Package" />
                  </form>
                  </li>
                {% endif %}
            </ul>
        </div>
        <table class="listing">
            <tr>
                <th>Architecture:</th>
                <td>{{ pkg.arch.name }}</td>
            </tr><tr>
                <th>Repository:</th>
                <td>{{ pkg.repo.name|capfirst }}</td>
            </tr><tr>
                <th>Description:</th>
                <td>{% if pkg.pkgdesc %}{{ pkg.pkgdesc }}{% endif %}</td>
            </tr><tr>
                <th>Upstream URL:</th>
                <td>{% if pkg.url %}<a href="{{ pkg.url }}">{{ pkg.url }}</a>{% endif %}</td>
            </tr><tr>
                <th>License:</th>
                <td>{{ pkg.license }}</td>
            </tr><tr>
                <th>Maintainer:</th>
                <td>{% if pkg.maintainer %}{{ pkg.maintainer.get_full_name }}{% else %}None{% endif %}</td>
            </tr><tr>
                <th>Package Size:</th>
                <td>{{ pkg.compressed_size|filesizeformat }}</td>
            </tr><tr>
                <th>Installed Size:</th>
                <td>{{ pkg.installed_size|filesizeformat }}</td>
            </tr><tr>
                <th>Build Date:</th>
                <td>{{ pkg.build_date }} UTC</td>
            </tr><tr>
                <th>Last Updated:</th>
                <td>{{ pkg.last_update|date:"Y-m-d" }}</td>
            </tr>
        </table>
        <br />
        <table width="100%">
            <tr>
                <td valign="top" width="50%">
                    {% with pkg.get_depends as deps %}
                    <div class="listing">
                        <h4>Dependencies ({{deps|length}}):</h4>
                        {% if deps %}
                        <ul style="font-size:small;list-style:none">
                        {% for depend in deps %}
                          {% ifequal depend.pkg None %}
                            <li>{{ depend.dep.depname }} (virtual)</li>
                          {% else %}
                            <li><a href="{{ depend.pkg.get_absolute_url }}">{{ depend.dep.depname }}</a>{{ depend.dep.depvcmp }}</li>
                          {% endifequal %}
                        {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                    {% endwith %}
                </td>
                <td valign="top">
                    {% with pkg.get_requiredby as rqdby %}
                    <div class="listing">
                        <h4>Required By ({{rqdby|length}}):</h4>
                        {% if rqdby %}
                        <ul style="font-size:small;list-style:none">
                        {% for req in rqdby %}
                        <li><a href="{{req.get_absolute_url}}">{{ req.pkgname }}{% ifequal req.repo.name "Testing" %} (testing){% endifequal %}{% ifequal req.repo.name "Unstable" %} (unstable){% endifequal %}</a></li>
                        {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                    {% endwith %}
                </td>
            </tr>
        </table>
        <div class="listing" id="filelist">
            <h4>Files:</h4>
            <p style="padding: 10px 20px;">
                <a id="filelink" href="files/">View File List</a>
            </p>
        </div>
    </div>
<script type="text/javascript" src="/media/jquery-1.4.1.min.js"></script>
<script type="text/javascript">
function ajaxifyFiles() {
    $('#filelink').click(function(event) {
        event.preventDefault();
        $.get(this.href, function(data) {
            $('#filelist').html(data);
        });
    });
}
$(document).ready(ajaxifyFiles);
</script>
{% endblock %}

